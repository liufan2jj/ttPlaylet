"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var component_1=require("../common/component"),touch_1=require("../mixins/touch"),version_1=require("../common/version"),utils_1=require("../common/utils"),DRAG_STATUS={START:"start",MOVING:"moving",END:"end"};(0,component_1.VantComponent)({mixins:[touch_1.touch],props:{range:Boolean,disabled:Boolean,useButtonSlot:Boolean,activeColor:String,inactiveColor:String,max:{type:Number,value:100},min:{type:Number,value:0},step:{type:Number,value:1},value:{type:null,value:0,observer:function(t){t!==this.value&&this.updateValue(t)}},vertical:Boolean,barHeight:null},created:function(){this.updateValue(this.data.value)},methods:{onTouchStart:function(t){var a=this;if(!this.data.disabled){var e=t.currentTarget.dataset.index;"number"==typeof e&&(this.buttonIndex=e),this.touchStart(t),this.startValue=this.format(this.value),this.newValue=this.value,this.isRange(this.newValue)?this.startValue=this.newValue.map((function(t){return a.format(t)})):this.startValue=this.format(this.newValue),this.dragStatus=DRAG_STATUS.START}},onTouchMove:function(t){var a=this;this.data.disabled||(this.dragStatus===DRAG_STATUS.START&&this.$emit("drag-start"),this.touchMove(t),this.dragStatus=DRAG_STATUS.MOVING,(0,utils_1.getRect)(this,".van-slider").then((function(t){var e=a.data.vertical,i=(e?a.deltaY:a.deltaX)/(e?t.height:t.width)*a.getRange();a.isRange(a.startValue)?a.newValue[a.buttonIndex]=a.startValue[a.buttonIndex]+i:a.newValue=a.startValue+i,a.updateValue(a.newValue,!1,!0)})))},onTouchEnd:function(){var t=this;this.data.disabled||this.dragStatus===DRAG_STATUS.MOVING&&(this.dragStatus=DRAG_STATUS.END,(0,utils_1.nextTick)((function(){t.updateValue(t.newValue,!0),t.$emit("drag-end")})))},onClick:function(t){var a=this;if(!this.data.disabled){var e=this.data.min;(0,utils_1.getRect)(this,".van-slider").then((function(i){var n=a.data.vertical,s=t.touches[0],u=n?s.clientY-i.top:s.clientX-i.left,r=n?i.height:i.width,o=Number(e)+u/r*a.getRange();if(a.isRange(a.value)){var h=a.value,l=h[0],c=h[1];o<=(l+c)/2?a.updateValue([o,c],!0):a.updateValue([l,o],!0)}else a.updateValue(o,!0)}))}},isRange:function(t){return this.data.range&&Array.isArray(t)},handleOverlap:function(t){return t[0]>t[1]?t.slice(0).reverse():t},updateValue:function(t,a,e){var i=this;t=this.isRange(t)?this.handleOverlap(t).map((function(t){return i.format(t)})):this.format(t),this.value=t;var n=this.data.vertical,s=n?"height":"width";this.setData({wrapperStyle:"\n          background: ".concat(this.data.inactiveColor||"",";\n          ").concat(n?"width":"height",": ").concat((0,utils_1.addUnit)(this.data.barHeight)||"",";\n        "),barStyle:"\n          ".concat(s,": ").concat(this.calcMainAxis(),";\n          left: ").concat(n?0:this.calcOffset(),";\n          top: ").concat(n?this.calcOffset():0,";\n          ").concat(e?"transition: none;":"","\n        ")}),e&&this.$emit("drag",{value:t}),a&&this.$emit("change",t),(e||a)&&(0,version_1.canIUseModel)()&&this.setData({value:t})},getScope:function(){return Number(this.data.max)-Number(this.data.min)},getRange:function(){var t=this.data;return t.max-t.min},getOffsetWidth:function(t,a){var e=this.getScope();return"".concat(Math.max(100*(t-a)/e,0),"%")},calcMainAxis:function(){var t=this.value,a=this.data.min;return this.isRange(t)?this.getOffsetWidth(t[1],t[0]):this.getOffsetWidth(t,Number(a))},calcOffset:function(){var t=this.value,a=this.data.min,e=this.getScope();return this.isRange(t)?"".concat(100*(t[0]-Number(a))/e,"%"):"0%"},format:function(t){var a=+this.data.min,e=+this.data.max,i=+this.data.step;t=(0,utils_1.clamp)(t,a,e);var n=Math.round((t-a)/i)*i;return(0,utils_1.addNumber)(a,n)}}});
//# sourceMappingURL=index.js.map