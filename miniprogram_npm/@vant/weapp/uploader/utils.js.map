{"version":3,"file":"node_modules\\@vant\\weapp\\lib\\uploader\\utils.js","names":["__assign","this","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","defineProperty","exports","value","chooseFile","isVideoFile","isImageFile","utils_1","require","validator_1","item","isImage","type","url","isImageUrl","isVideo","isVideoUrl","formatImage","res","tempFiles","map","pickExclude","tempFilePath","path","thumb","formatVideo","thumbTempFilePath","formatMedia","fileType","formatFile","_a","accept","multiple","capture","compressed","maxDuration","sizeType","camera","maxCount","mediaType","extension","Promise","resolve","reject","isPC","isWxWork","wx","chooseImage","count","Math","min","sourceType","success","fail","chooseMedia","chooseVideo","chooseMessageFile"],"sources":["node_modules\\@vant\\weapp\\lib\\uploader\\utils.js"],"sourcesContent":["\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.chooseFile = exports.isVideoFile = exports.isImageFile = void 0;\nvar utils_1 = require(\"../common/utils\");\nvar validator_1 = require(\"../common/validator\");\nfunction isImageFile(item) {\n    if (item.isImage != null) {\n        return item.isImage;\n    }\n    if (item.type) {\n        return item.type === 'image';\n    }\n    if (item.url) {\n        return (0, validator_1.isImageUrl)(item.url);\n    }\n    return false;\n}\nexports.isImageFile = isImageFile;\nfunction isVideoFile(item) {\n    if (item.isVideo != null) {\n        return item.isVideo;\n    }\n    if (item.type) {\n        return item.type === 'video';\n    }\n    if (item.url) {\n        return (0, validator_1.isVideoUrl)(item.url);\n    }\n    return false;\n}\nexports.isVideoFile = isVideoFile;\nfunction formatImage(res) {\n    return res.tempFiles.map(function (item) { return (__assign(__assign({}, (0, utils_1.pickExclude)(item, ['path'])), { type: 'image', url: item.tempFilePath || item.path, thumb: item.tempFilePath || item.path })); });\n}\nfunction formatVideo(res) {\n    return [\n        __assign(__assign({}, (0, utils_1.pickExclude)(res, ['tempFilePath', 'thumbTempFilePath', 'errMsg'])), { type: 'video', url: res.tempFilePath, thumb: res.thumbTempFilePath }),\n    ];\n}\nfunction formatMedia(res) {\n    return res.tempFiles.map(function (item) { return (__assign(__assign({}, (0, utils_1.pickExclude)(item, ['fileType', 'thumbTempFilePath', 'tempFilePath'])), { type: item.fileType, url: item.tempFilePath, thumb: item.fileType === 'video' ? item.thumbTempFilePath : item.tempFilePath })); });\n}\nfunction formatFile(res) {\n    return res.tempFiles.map(function (item) { return (__assign(__assign({}, (0, utils_1.pickExclude)(item, ['path'])), { url: item.path })); });\n}\nfunction chooseFile(_a) {\n    var accept = _a.accept, multiple = _a.multiple, capture = _a.capture, compressed = _a.compressed, maxDuration = _a.maxDuration, sizeType = _a.sizeType, camera = _a.camera, maxCount = _a.maxCount, mediaType = _a.mediaType, extension = _a.extension;\n    return new Promise(function (resolve, reject) {\n        switch (accept) {\n            case 'image':\n                if (utils_1.isPC || utils_1.isWxWork) {\n                    wx.chooseImage({\n                        count: multiple ? Math.min(maxCount, 9) : 1,\n                        sourceType: capture,\n                        sizeType: sizeType,\n                        success: function (res) { return resolve(formatImage(res)); },\n                        fail: reject,\n                    });\n                }\n                else {\n                    wx.chooseMedia({\n                        count: multiple ? Math.min(maxCount, 9) : 1,\n                        mediaType: ['image'],\n                        sourceType: capture,\n                        maxDuration: maxDuration,\n                        sizeType: sizeType,\n                        camera: camera,\n                        success: function (res) { return resolve(formatImage(res)); },\n                        fail: reject,\n                    });\n                }\n                break;\n            case 'media':\n                wx.chooseMedia({\n                    count: multiple ? Math.min(maxCount, 9) : 1,\n                    mediaType: mediaType,\n                    sourceType: capture,\n                    maxDuration: maxDuration,\n                    sizeType: sizeType,\n                    camera: camera,\n                    success: function (res) { return resolve(formatMedia(res)); },\n                    fail: reject,\n                });\n                break;\n            case 'video':\n                wx.chooseVideo({\n                    sourceType: capture,\n                    compressed: compressed,\n                    maxDuration: maxDuration,\n                    camera: camera,\n                    success: function (res) { return resolve(formatVideo(res)); },\n                    fail: reject,\n                });\n                break;\n            default:\n                wx.chooseMessageFile(__assign(__assign({ count: multiple ? maxCount : 1, type: accept }, (extension ? { extension: extension } : {})), { success: function (res) { return resolve(formatFile(res)); }, fail: reject }));\n                break;\n        }\n    });\n}\nexports.chooseFile = chooseFile;\n"],"mappings":"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","ignoreList":[]}