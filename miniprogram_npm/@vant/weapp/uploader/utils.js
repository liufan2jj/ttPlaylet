"use strict";var __assign=this&&this.__assign||function(){return __assign=Object.assign||function(e){for(var i,t=1,a=arguments.length;t<a;t++)for(var s in i=arguments[t])Object.prototype.hasOwnProperty.call(i,s)&&(e[s]=i[s]);return e},__assign.apply(this,arguments)};Object.defineProperty(exports,"__esModule",{value:!0}),exports.chooseFile=exports.isVideoFile=exports.isImageFile=void 0;var utils_1=require("../common/utils"),validator_1=require("../common/validator");function isImageFile(e){return null!=e.isImage?e.isImage:e.type?"image"===e.type:!!e.url&&(0,validator_1.isImageUrl)(e.url)}function isVideoFile(e){return null!=e.isVideo?e.isVideo:e.type?"video"===e.type:!!e.url&&(0,validator_1.isVideoUrl)(e.url)}function formatImage(e){return e.tempFiles.map((function(e){return __assign(__assign({},(0,utils_1.pickExclude)(e,["path"])),{type:"image",url:e.tempFilePath||e.path,thumb:e.tempFilePath||e.path})}))}function formatVideo(e){return[__assign(__assign({},(0,utils_1.pickExclude)(e,["tempFilePath","thumbTempFilePath","errMsg"])),{type:"video",url:e.tempFilePath,thumb:e.thumbTempFilePath})]}function formatMedia(e){return e.tempFiles.map((function(e){return __assign(__assign({},(0,utils_1.pickExclude)(e,["fileType","thumbTempFilePath","tempFilePath"])),{type:e.fileType,url:e.tempFilePath,thumb:"video"===e.fileType?e.thumbTempFilePath:e.tempFilePath})}))}function formatFile(e){return e.tempFiles.map((function(e){return __assign(__assign({},(0,utils_1.pickExclude)(e,["path"])),{url:e.path})}))}function chooseFile(e){var i=e.accept,t=e.multiple,a=e.capture,s=e.compressed,r=e.maxDuration,o=e.sizeType,n=e.camera,u=e.maxCount,l=e.mediaType,c=e.extension;return new Promise((function(e,m){switch(i){case"image":utils_1.isPC||utils_1.isWxWork?wx.chooseImage({count:t?Math.min(u,9):1,sourceType:a,sizeType:o,success:function(i){return e(formatImage(i))},fail:m}):wx.chooseMedia({count:t?Math.min(u,9):1,mediaType:["image"],sourceType:a,maxDuration:r,sizeType:o,camera:n,success:function(i){return e(formatImage(i))},fail:m});break;case"media":wx.chooseMedia({count:t?Math.min(u,9):1,mediaType:l,sourceType:a,maxDuration:r,sizeType:o,camera:n,success:function(i){return e(formatMedia(i))},fail:m});break;case"video":wx.chooseVideo({sourceType:a,compressed:s,maxDuration:r,camera:n,success:function(i){return e(formatVideo(i))},fail:m});break;default:wx.chooseMessageFile(__assign(__assign({count:t?u:1,type:i},c?{extension:c}:{}),{success:function(i){return e(formatFile(i))},fail:m}))}}))}exports.isImageFile=isImageFile,exports.isVideoFile=isVideoFile,exports.chooseFile=chooseFile;
//# sourceMappingURL=utils.js.map