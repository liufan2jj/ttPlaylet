{"version":3,"file":"node_modules\\@vant\\weapp\\lib\\sticky\\index.js","names":["Object","defineProperty","exports","value","utils_1","require","component_1","validator_1","page_scroll_1","ROOT_ELEMENT","VantComponent","props","zIndex","type","Number","offsetTop","observer","disabled","Boolean","container","scrollTop","val","this","onScroll","mixins","pageScrollMixin","event","data","height","fixed","transform","mounted","methods","_a","_this","_c","setDataAfterDiff","getRect","then","root","isDef","width","top","Promise","all","getContainerRect","catch","wx","nextTick","diff","keys","reduce","prev","key","length","setData","$emit","isFixed","nodesRef","resolve","boundingClientRect","exec","reject","Error"],"sources":["node_modules\\@vant\\weapp\\lib\\sticky\\index.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar utils_1 = require(\"../common/utils\");\nvar component_1 = require(\"../common/component\");\nvar validator_1 = require(\"../common/validator\");\nvar page_scroll_1 = require(\"../mixins/page-scroll\");\nvar ROOT_ELEMENT = '.van-sticky';\n(0, component_1.VantComponent)({\n    props: {\n        zIndex: {\n            type: Number,\n            value: 99,\n        },\n        offsetTop: {\n            type: Number,\n            value: 0,\n            observer: 'onScroll',\n        },\n        disabled: {\n            type: Boolean,\n            observer: 'onScroll',\n        },\n        container: {\n            type: null,\n            observer: 'onScroll',\n        },\n        scrollTop: {\n            type: null,\n            observer: function (val) {\n                this.onScroll({ scrollTop: val });\n            },\n        },\n    },\n    mixins: [\n        (0, page_scroll_1.pageScrollMixin)(function (event) {\n            if (this.data.scrollTop != null) {\n                return;\n            }\n            this.onScroll(event);\n        }),\n    ],\n    data: {\n        height: 0,\n        fixed: false,\n        transform: 0,\n    },\n    mounted: function () {\n        this.onScroll();\n    },\n    methods: {\n        onScroll: function (_a) {\n            var _this = this;\n            var _b = _a === void 0 ? {} : _a, scrollTop = _b.scrollTop;\n            var _c = this.data, container = _c.container, offsetTop = _c.offsetTop, disabled = _c.disabled;\n            if (disabled) {\n                this.setDataAfterDiff({\n                    fixed: false,\n                    transform: 0,\n                });\n                return;\n            }\n            this.scrollTop = scrollTop || this.scrollTop;\n            if (typeof container === 'function') {\n                Promise.all([(0, utils_1.getRect)(this, ROOT_ELEMENT), this.getContainerRect()])\n                    .then(function (_a) {\n                    var root = _a[0], container = _a[1];\n                    if (offsetTop + root.height > container.height + container.top) {\n                        _this.setDataAfterDiff({\n                            fixed: false,\n                            transform: container.height - root.height,\n                        });\n                    }\n                    else if (offsetTop >= root.top) {\n                        _this.setDataAfterDiff({\n                            fixed: true,\n                            height: root.height,\n                            transform: 0,\n                        });\n                    }\n                    else {\n                        _this.setDataAfterDiff({ fixed: false, transform: 0 });\n                    }\n                })\n                    .catch(function () { });\n                return;\n            }\n            (0, utils_1.getRect)(this, ROOT_ELEMENT).then(function (root) {\n                if (!(0, validator_1.isDef)(root) || (!root.width && !root.height)) {\n                    return;\n                }\n                if (offsetTop >= root.top) {\n                    _this.setDataAfterDiff({ fixed: true, height: root.height });\n                    _this.transform = 0;\n                }\n                else {\n                    _this.setDataAfterDiff({ fixed: false });\n                }\n            });\n        },\n        setDataAfterDiff: function (data) {\n            var _this = this;\n            wx.nextTick(function () {\n                var diff = Object.keys(data).reduce(function (prev, key) {\n                    if (data[key] !== _this.data[key]) {\n                        prev[key] = data[key];\n                    }\n                    return prev;\n                }, {});\n                if (Object.keys(diff).length > 0) {\n                    _this.setData(diff);\n                }\n                _this.$emit('scroll', {\n                    scrollTop: _this.scrollTop,\n                    isFixed: data.fixed || _this.data.fixed,\n                });\n            });\n        },\n        getContainerRect: function () {\n            var nodesRef = this.data.container();\n            if (!nodesRef) {\n                return Promise.reject(new Error('not found container'));\n            }\n            return new Promise(function (resolve) { return nodesRef.boundingClientRect(resolve).exec(); });\n        },\n    },\n});\n"],"mappings":"AAAA,aACAA,OAAOC,eAAeC,QAAS,aAAc,CAAEC,OAAO,IACtD,IAAIC,QAAUC,QAAQ,mBAClBC,YAAcD,QAAQ,uBACtBE,YAAcF,QAAQ,uBACtBG,cAAgBH,QAAQ,yBACxBI,aAAe,eACnB,EAAIH,YAAYI,eAAe,CAC3BC,MAAO,CACHC,OAAQ,CACJC,KAAMC,OACNX,MAAO,IAEXY,UAAW,CACPF,KAAMC,OACNX,MAAO,EACPa,SAAU,YAEdC,SAAU,CACNJ,KAAMK,QACNF,SAAU,YAEdG,UAAW,CACPN,KAAM,KACNG,SAAU,YAEdI,UAAW,CACPP,KAAM,KACNG,SAAU,SAAUK,GAChBC,KAAKC,SAAS,CAAEH,UAAWC,GAC/B,IAGRG,OAAQ,EACJ,EAAIhB,cAAciB,kBAAiB,SAAUC,GACd,MAAvBJ,KAAKK,KAAKP,WAGdE,KAAKC,SAASG,EAClB,KAEJC,KAAM,CACFC,OAAQ,EACRC,OAAO,EACPC,UAAW,GAEfC,QAAS,WACLT,KAAKC,UACT,EACAS,QAAS,CACLT,SAAU,SAAUU,GAChB,IAAIC,EAAQZ,KACsBF,QAAlB,IAAPa,EAAgB,CAAC,EAAIA,GAAmBb,UAC7Ce,EAAKb,KAAKK,KAAMR,EAAYgB,EAAGhB,UAAWJ,EAAYoB,EAAGpB,UAAsBoB,EAAGlB,SAElFK,KAAKc,iBAAiB,CAClBP,OAAO,EACPC,UAAW,KAInBR,KAAKF,UAAYA,GAAaE,KAAKF,UACV,mBAAdD,GAwBX,EAAIf,QAAQiC,SAASf,KAAMb,cAAc6B,MAAK,SAAUC,IAC/C,EAAIhC,YAAYiC,OAAOD,KAAWA,EAAKE,OAAUF,EAAKX,UAGvDb,GAAawB,EAAKG,KAClBR,EAAME,iBAAiB,CAAEP,OAAO,EAAMD,OAAQW,EAAKX,SACnDM,EAAMJ,UAAY,GAGlBI,EAAME,iBAAiB,CAAEP,OAAO,IAExC,IAlCIc,QAAQC,IAAI,EAAC,EAAIxC,QAAQiC,SAASf,KAAMb,cAAea,KAAKuB,qBACvDP,MAAK,SAAUL,GAChB,IAAIM,EAAON,EAAG,GAAId,EAAYc,EAAG,GAC7BlB,EAAYwB,EAAKX,OAAST,EAAUS,OAAST,EAAUuB,IACvDR,EAAME,iBAAiB,CACnBP,OAAO,EACPC,UAAWX,EAAUS,OAASW,EAAKX,SAGlCb,GAAawB,EAAKG,IACvBR,EAAME,iBAAiB,CACnBP,OAAO,EACPD,OAAQW,EAAKX,OACbE,UAAW,IAIfI,EAAME,iBAAiB,CAAEP,OAAO,EAAOC,UAAW,GAE1D,IACKgB,OAAM,WAAc,IAejC,EACAV,iBAAkB,SAAUT,GACxB,IAAIO,EAAQZ,KACZyB,GAAGC,UAAS,WACR,IAAIC,EAAOjD,OAAOkD,KAAKvB,GAAMwB,QAAO,SAAUC,EAAMC,GAIhD,OAHI1B,EAAK0B,KAASnB,EAAMP,KAAK0B,KACzBD,EAAKC,GAAO1B,EAAK0B,IAEdD,CACX,GAAG,CAAC,GACApD,OAAOkD,KAAKD,GAAMK,OAAS,GAC3BpB,EAAMqB,QAAQN,GAElBf,EAAMsB,MAAM,SAAU,CAClBpC,UAAWc,EAAMd,UACjBqC,QAAS9B,EAAKE,OAASK,EAAMP,KAAKE,OAE1C,GACJ,EACAgB,iBAAkB,WACd,IAAIa,EAAWpC,KAAKK,KAAKR,YACzB,OAAKuC,EAGE,IAAIf,SAAQ,SAAUgB,GAAW,OAAOD,EAASE,mBAAmBD,GAASE,MAAQ,IAFjFlB,QAAQmB,OAAO,IAAIC,MAAM,uBAGxC","ignoreList":[]}