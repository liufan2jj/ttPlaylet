"use strict";var __spreadArray=this&&this.__spreadArray||function(e,t,a){if(a||2===arguments.length)for(var i,n=0,l=t.length;n<l;n++)!i&&n in t||(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))};Object.defineProperty(exports,"__esModule",{value:!0});var FieldName,component_1=require("../common/component");!function(e){e.TEXT="text",e.VALUE="value",e.CHILDREN="children"}(FieldName||(FieldName={}));var defaultFieldNames={text:FieldName.TEXT,value:FieldName.VALUE,children:FieldName.CHILDREN};(0,component_1.VantComponent)({props:{title:String,value:{type:String},placeholder:{type:String,value:"请选择"},activeColor:{type:String,value:"#1989fa"},options:{type:Array,value:[]},swipeable:{type:Boolean,value:!1},closeable:{type:Boolean,value:!0},showHeader:{type:Boolean,value:!0},closeIcon:{type:String,value:"cross"},fieldNames:{type:Object,value:defaultFieldNames,observer:"updateFieldNames"},useTitleSlot:Boolean},data:{tabs:[],activeTab:0,textKey:FieldName.TEXT,valueKey:FieldName.VALUE,childrenKey:FieldName.CHILDREN,innerValue:""},watch:{options:function(){this.updateTabs()},value:function(e){this.updateValue(e)}},created:function(){this.updateTabs()},methods:{updateValue:function(e){var t=this;if(void 0!==e&&this.data.tabs.map((function(e){return e.selected&&e.selected[t.data.valueKey]})).indexOf(e)>-1)return;this.innerValue=e,this.updateTabs()},updateFieldNames:function(){var e=this.data.fieldNames||defaultFieldNames,t=e.text,a=void 0===t?"text":t,i=e.value,n=void 0===i?"value":i,l=e.children,s=void 0===l?"children":l;this.setData({textKey:a,valueKey:n,childrenKey:s})},getSelectedOptionsByValue:function(e,t){for(var a=0;a<e.length;a++){var i=e[a];if(i[this.data.valueKey]===t)return[i];if(i[this.data.childrenKey]){var n=this.getSelectedOptionsByValue(i[this.data.childrenKey],t);if(n)return __spreadArray([i],n,!0)}}},updateTabs:function(){var e=this,t=this.data.options,a=this.innerValue;if(t.length){if(void 0!==a){var i=this.getSelectedOptionsByValue(t,a);if(i){var n=t,l=i.map((function(t){var a={options:n,selected:t},i=n.find((function(a){return a[e.data.valueKey]===t[e.data.valueKey]}));return i&&(n=i[e.data.childrenKey]),a}));return n&&l.push({options:n,selected:null}),this.setData({tabs:l}),void wx.nextTick((function(){e.setData({activeTab:l.length-1})}))}}this.setData({tabs:[{options:t,selected:null}],activeTab:0})}},onClose:function(){this.$emit("close")},onClickTab:function(e){var t=e.detail,a=t.index,i=t.title;this.$emit("click-tab",{title:i,tabIndex:a}),this.setData({activeTab:a})},onSelect:function(e){var t=this,a=e.currentTarget.dataset,i=a.option,n=a.tabIndex;if(!i||!i.disabled){var l=this.data,s=l.valueKey,r=l.childrenKey,o=this.data.tabs;if(o[n].selected=i,o.length>n+1&&(o=o.slice(0,n+1)),i[r]){var d={options:i[r],selected:null};o[n+1]?o[n+1]=d:o.push(d),wx.nextTick((function(){t.setData({activeTab:n+1})}))}this.setData({tabs:o});var u=o.map((function(e){return e.selected})).filter(Boolean),c=i[s],h={value:c,tabIndex:n,selectedOptions:u};this.innerValue=c,this.$emit("change",h),i[r]||this.$emit("finish",h)}}}});
//# sourceMappingURL=index.js.map