{"version":3,"file":"node_modules\\@vant\\weapp\\lib\\index-bar\\index.js","names":["Object","defineProperty","exports","value","color_1","require","component_1","relation_1","utils_1","page_scroll_1","indexList","charCodeOfA","charCodeAt","i","push","String","fromCharCode","VantComponent","relation","useChildren","this","updateData","props","sticky","type","Boolean","zIndex","Number","highlightColor","GREEN","stickyOffsetTop","Array","mixins","pageScrollMixin","event","scrollTop","onScroll","data","activeAnchorIndex","showSidebar","created","methods","_this","wx","nextTick","timer","clearTimeout","setTimeout","setData","children","length","setRect","then","Promise","all","setAnchorsRect","setListRect","setSiderbarRect","map","anchor","getRect","rect","assign","height","top","isDef","res","sidebar","setDiffData","_a","target","diffData","keys","forEach","key","getAnchorRect","getActiveAnchorIndex","_b","preAnchorHeight","_c","active","isActiveAnchorSticky_1","item","index","wrapperStyle","anchorStyle","concat","currentAnchor","currentOffsetTop","translateY","onClick","scrollToAnchor","dataset","onTouchMove","sidebarLength","touch","touches","itemHeight","Math","floor","clientY","onTouchStop","scrollToAnchorIndex","find","scrollIntoView","$emit"],"sources":["node_modules\\@vant\\weapp\\lib\\index-bar\\index.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar color_1 = require(\"../common/color\");\nvar component_1 = require(\"../common/component\");\nvar relation_1 = require(\"../common/relation\");\nvar utils_1 = require(\"../common/utils\");\nvar page_scroll_1 = require(\"../mixins/page-scroll\");\nvar indexList = function () {\n    var indexList = [];\n    var charCodeOfA = 'A'.charCodeAt(0);\n    for (var i = 0; i < 26; i++) {\n        indexList.push(String.fromCharCode(charCodeOfA + i));\n    }\n    return indexList;\n};\n(0, component_1.VantComponent)({\n    relation: (0, relation_1.useChildren)('index-anchor', function () {\n        this.updateData();\n    }),\n    props: {\n        sticky: {\n            type: Boolean,\n            value: true,\n        },\n        zIndex: {\n            type: Number,\n            value: 1,\n        },\n        highlightColor: {\n            type: String,\n            value: color_1.GREEN,\n        },\n        stickyOffsetTop: {\n            type: Number,\n            value: 0,\n        },\n        indexList: {\n            type: Array,\n            value: indexList(),\n        },\n    },\n    mixins: [\n        (0, page_scroll_1.pageScrollMixin)(function (event) {\n            this.scrollTop = (event === null || event === void 0 ? void 0 : event.scrollTop) || 0;\n            this.onScroll();\n        }),\n    ],\n    data: {\n        activeAnchorIndex: null,\n        showSidebar: false,\n    },\n    created: function () {\n        this.scrollTop = 0;\n    },\n    methods: {\n        updateData: function () {\n            var _this = this;\n            wx.nextTick(function () {\n                if (_this.timer != null) {\n                    clearTimeout(_this.timer);\n                }\n                _this.timer = setTimeout(function () {\n                    _this.setData({\n                        showSidebar: !!_this.children.length,\n                    });\n                    _this.setRect().then(function () {\n                        _this.onScroll();\n                    });\n                }, 0);\n            });\n        },\n        setRect: function () {\n            return Promise.all([\n                this.setAnchorsRect(),\n                this.setListRect(),\n                this.setSiderbarRect(),\n            ]);\n        },\n        setAnchorsRect: function () {\n            var _this = this;\n            return Promise.all(this.children.map(function (anchor) {\n                return (0, utils_1.getRect)(anchor, '.van-index-anchor-wrapper').then(function (rect) {\n                    Object.assign(anchor, {\n                        height: rect.height,\n                        top: rect.top + _this.scrollTop,\n                    });\n                });\n            }));\n        },\n        setListRect: function () {\n            var _this = this;\n            return (0, utils_1.getRect)(this, '.van-index-bar').then(function (rect) {\n                if (!(0, utils_1.isDef)(rect)) {\n                    return;\n                }\n                Object.assign(_this, {\n                    height: rect.height,\n                    top: rect.top + _this.scrollTop,\n                });\n            });\n        },\n        setSiderbarRect: function () {\n            var _this = this;\n            return (0, utils_1.getRect)(this, '.van-index-bar__sidebar').then(function (res) {\n                if (!(0, utils_1.isDef)(res)) {\n                    return;\n                }\n                _this.sidebar = {\n                    height: res.height,\n                    top: res.top,\n                };\n            });\n        },\n        setDiffData: function (_a) {\n            var target = _a.target, data = _a.data;\n            var diffData = {};\n            Object.keys(data).forEach(function (key) {\n                if (target.data[key] !== data[key]) {\n                    diffData[key] = data[key];\n                }\n            });\n            if (Object.keys(diffData).length) {\n                target.setData(diffData);\n            }\n        },\n        getAnchorRect: function (anchor) {\n            return (0, utils_1.getRect)(anchor, '.van-index-anchor-wrapper').then(function (rect) { return ({\n                height: rect.height,\n                top: rect.top,\n            }); });\n        },\n        getActiveAnchorIndex: function () {\n            var _a = this, children = _a.children, scrollTop = _a.scrollTop;\n            var _b = this.data, sticky = _b.sticky, stickyOffsetTop = _b.stickyOffsetTop;\n            for (var i = this.children.length - 1; i >= 0; i--) {\n                var preAnchorHeight = i > 0 ? children[i - 1].height : 0;\n                var reachTop = sticky ? preAnchorHeight + stickyOffsetTop : 0;\n                if (reachTop + scrollTop >= children[i].top) {\n                    return i;\n                }\n            }\n            return -1;\n        },\n        onScroll: function () {\n            var _this = this;\n            var _a = this, _b = _a.children, children = _b === void 0 ? [] : _b, scrollTop = _a.scrollTop;\n            if (!children.length) {\n                return;\n            }\n            var _c = this.data, sticky = _c.sticky, stickyOffsetTop = _c.stickyOffsetTop, zIndex = _c.zIndex, highlightColor = _c.highlightColor;\n            var active = this.getActiveAnchorIndex();\n            this.setDiffData({\n                target: this,\n                data: {\n                    activeAnchorIndex: active,\n                },\n            });\n            if (sticky) {\n                var isActiveAnchorSticky_1 = false;\n                if (active !== -1) {\n                    isActiveAnchorSticky_1 =\n                        children[active].top <= stickyOffsetTop + scrollTop;\n                }\n                children.forEach(function (item, index) {\n                    if (index === active) {\n                        var wrapperStyle = '';\n                        var anchorStyle = \"\\n              color: \".concat(highlightColor, \";\\n            \");\n                        if (isActiveAnchorSticky_1) {\n                            wrapperStyle = \"\\n                height: \".concat(children[index].height, \"px;\\n              \");\n                            anchorStyle = \"\\n                position: fixed;\\n                top: \".concat(stickyOffsetTop, \"px;\\n                z-index: \").concat(zIndex, \";\\n                color: \").concat(highlightColor, \";\\n              \");\n                        }\n                        _this.setDiffData({\n                            target: item,\n                            data: {\n                                active: true,\n                                anchorStyle: anchorStyle,\n                                wrapperStyle: wrapperStyle,\n                            },\n                        });\n                    }\n                    else if (index === active - 1) {\n                        var currentAnchor = children[index];\n                        var currentOffsetTop = currentAnchor.top;\n                        var targetOffsetTop = index === children.length - 1\n                            ? _this.top\n                            : children[index + 1].top;\n                        var parentOffsetHeight = targetOffsetTop - currentOffsetTop;\n                        var translateY = parentOffsetHeight - currentAnchor.height;\n                        var anchorStyle = \"\\n              position: relative;\\n              transform: translate3d(0, \".concat(translateY, \"px, 0);\\n              z-index: \").concat(zIndex, \";\\n              color: \").concat(highlightColor, \";\\n            \");\n                        _this.setDiffData({\n                            target: item,\n                            data: {\n                                active: true,\n                                anchorStyle: anchorStyle,\n                            },\n                        });\n                    }\n                    else {\n                        _this.setDiffData({\n                            target: item,\n                            data: {\n                                active: false,\n                                anchorStyle: '',\n                                wrapperStyle: '',\n                            },\n                        });\n                    }\n                });\n            }\n        },\n        onClick: function (event) {\n            this.scrollToAnchor(event.target.dataset.index);\n        },\n        onTouchMove: function (event) {\n            var sidebarLength = this.children.length;\n            var touch = event.touches[0];\n            var itemHeight = this.sidebar.height / sidebarLength;\n            var index = Math.floor((touch.clientY - this.sidebar.top) / itemHeight);\n            if (index < 0) {\n                index = 0;\n            }\n            else if (index > sidebarLength - 1) {\n                index = sidebarLength - 1;\n            }\n            this.scrollToAnchor(index);\n        },\n        onTouchStop: function () {\n            this.scrollToAnchorIndex = null;\n        },\n        scrollToAnchor: function (index) {\n            var _this = this;\n            if (typeof index !== 'number' || this.scrollToAnchorIndex === index) {\n                return;\n            }\n            this.scrollToAnchorIndex = index;\n            var anchor = this.children.find(function (item) { return item.data.index === _this.data.indexList[index]; });\n            if (anchor) {\n                anchor.scrollIntoView(this.scrollTop);\n                this.$emit('select', anchor.data.index);\n            }\n        },\n    },\n});\n"],"mappings":"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","ignoreList":[]}